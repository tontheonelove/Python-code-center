import requests
import json

# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å CoinGecko API
def get_top_10_cryptos():
    url = "https://api.coingecko.com/api/v3/coins/markets"
    params = {
        "vs_currency": "usd",  # ‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (USD)
        "order": "market_cap_desc",  # ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏´‡∏≤‡∏ô‡πâ‡∏≠‡∏¢
        "per_page": 10,  # ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 10 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡πÅ‡∏£‡∏Å
        "page": 1  # ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
    }
    response = requests.get(url, params=params)
    return response.json()

# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Discord Webhook
def send_to_discord(cryptos):
    webhook_url = "https://discord.com/api/webhooks/xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx""  # ‡πÉ‡∏™‡πà Webhook URL ‡∏Ç‡∏≠‡∏á Discord ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà

    # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Discord
    message = "üí• Top 10 Cryptocurrencies by Market Cap üí•\n\n"
    for idx, crypto in enumerate(cryptos, start=1):
        message += f"{idx}. {crypto['name']} ({crypto['symbol'].upper()})\n"
        message += f"   Price: ${crypto['current_price']}\n"
        message += f"   Market Cap: ${crypto['market_cap']}\n"
        message += f"   24h Change: {crypto['price_change_percentage_24h']}%\n\n"

    # ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Discord
    data = {"content": message}
    response = requests.post(webhook_url, data=json.dumps(data), headers={"Content-Type": "application/json"})

    if response.status_code == 204:
        print("Message successfully sent to Discord!")
    else:
        print(f"Failed to send message: {response.status_code}")

# ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Discord
cryptos = get_top_10_cryptos()
send_to_discord(cryptos)
